<!doctype html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1"> 

  <title>Agenda Pública</title>

  <link rel="stylesheet" href="themes/agenda.min.css" />
  <link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
  <link rel="stylesheet" href="themes/jquery.mobile.datepicker.theme.css" />
  <link rel="stylesheet" href="css/jquery.mobile.structure-1.4.5.min.css" />
  <link rel="stylesheet" href="css/jquery.mobile.datepicker.css" />
  <link rel="stylesheet" href="css/ubuntu.css" />
  <link rel="stylesheet" href="css/settings.css" />

  <script src="cordova.js"></script>
  <script src="js/jquery-1.11.3.min.js"></script>
  <script src="js/jquery.mobile-1.4.5.min.js"></script>
  <script src="js/jquery.ui.datepicker.js"></script>
  <script src="js/jquery.mobile.datepicker.js"></script>
  <script src="js/jquery.dotdotdot.min.js"></script>
  <script src="js/moment-with-locales.min.js"></script>
  <script src="js/handlebars-v4.0.5.js"></script>
  <script src="js/agenda.js"></script>
</head>

<body onload="onLoad()">
  <!-- página principal -->
  <div data-role="page" id="index" data-theme="a">
    <!-- painel menu -->
    <div data-role="panel" data-position="left" data-display="push" id="menu">
      <ul data-role="listview" class="ui-listview-outer">
        <li><a href="#sobrepage">Sobre</a></li>
        <li><a href="#" onClick="eventoRefresh();">Recarregar eventos</a></li>
      </ul>
    </div>
    <!-- calendário -->
    <div data-role="popup" id="calendario">
      <div>
        <input id="data" onChange="selecionaData()" type="hidden" data-inline="true" />
      </div>
      <div>
        <a href="#" class="ui-btn ui-corner-all ui-shadow" style="margin: .5em;" onClick="carregaBusca(false);">Exibir mês</a>
      </div>
    </div>
    <!-- header -->
    <div data-role="header" class="header" data-position="fixed" data-theme="b">
      <a href="#menu" class="ui-btn ui-icon-bars ui-btn-icon-notext ui-corner-all"></a>
      <h1>Agenda Pública</h1>
      <a href="#calendario" data-rel="popup" class="ui-btn ui-icon-calendar ui-btn-icon-notext ui-corner-all"></a>
    </div>
    <!-- conteúdo -->
    <div data-role="content" id="eventos">
      <script id="eventos-template" type="text/x-handlebars-template">
        <ul data-role="listview">
          <li><h1>{{mes}}</h1></li>
          {{#each eventos}}
            <li id='{{@key}}' data-role='list-divider' class='ui-list-count' style='white-space: normal'>
            <span style='display: inline; float: left;'>{{formataDia @key}}</span>
            <span style='display: inline; float: right;'>{{formataRelativo @key}}</span>
            </li>
            {{#each this}}
              <li><a href='#' onClick='loadEvent({{@../key}},{{id}});'>
              <h2 class='event-title event-overflow'>{{titulo}}</h2>
              <p class='event-desc event-overflow'><strong>{{formataDescricao descricao}}</strong></p>
              <p>{{local}}</p>
              <p class='ui-li-aside'><strong>{{horario}}</strong></p>
              </a></li>
            {{/each}}
          {{else}}
            <li><h3>Não há eventos para o mês escolhido!</h3></li>
          {{/each}}
        </ul>
      </script>
    </div>
    <!-- painel de evento -->
    <div data-role="panel" data-position="right" data-display="overlay" id="info-panel">
      <div id="info">
        <script id="info-template" type="text/x-handlebars-template">
          <h2>{{titulo}}</h2>
          <h4>{{formataDescricao descricao}}</h4>
          <p>{{local}}</p>
          <p>{{endereco}}</p>
          {{#if_mesmoDia data_inicio data_fim}}
            <p>Quando: {{formataData data_inicio}}</p>
          {{else}}
            <p>Quando: {{formataData data_inicio}} até {{formataData data_fim}}</p>
          {{/if_mesmoDia}}
          {{#if_mesmaHora data_inicio data_fim}}
            <p>Horário: {{formataHora data_inicio}}</p>
          {{else}}
            <p>Horário: {{formataHora data_inicio}} até {{formataHora data_fim}}</p>
          {{/if_mesmaHora}}
          <p><a href="#" onclick="window.open('{{link}}', '_system');">Saiba mais</a></p>
        </script>
      </div>
    </div>
  </div>
  
  <!-- página sobre -->
  <div data-role="page" id="sobrepage" data-theme="a">
    <!-- header -->
    <div data-role="header" data-position="fixed" data-theme="b">
      <a href="#index" class="ui-btn ui-icon-back ui-btn-icon-notext ui-corner-all"></a>
      <h1>Agenda Pública</h1>
    </div>
    <!-- conteúdo -->
    <div id="sobre">
      <center>
        <br /><br />
        <img src="img/ico.png" />
        <h1>Agenda Pública</h1>
        <p>Desenvolvido por <a href="http://labhacker.org.br/">LabHacker</a></p>
      </center>
    </div>
  </div>
</body>
</html>
